<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hey Vic, I Miss You</title>
  <meta name="description" content="A tiny love note on the web." />
  <style>
    :root {
      --bg: #0f1225;
      --card: #161a34cc;
      --text: #f3f4f7;
      --muted: #a9acc5;
      --accent: #9b87f5;
      --accent-2: #ff7ab6;
    }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--text);
      background: radial-gradient(1200px 800px at 80% -10%, #1e2246 0%, #0f1225 60%), #0f1225;
      display: grid;
      place-items: center;
      min-height: 100vh;
    }
    .wrap {
      width: min(92vw, 900px);
      padding: 28px;
      border-radius: 24px;
      background: linear-gradient(180deg, #ffffff12, #ffffff05);
      backdrop-filter: blur(8px);
      box-shadow: 0 10px 40px rgba(0,0,0,.35);
      border: 1px solid #ffffff18;
    }
    h1 {
      font-size: clamp(28px, 4.8vw, 64px);
      margin: 0 0 10px;
    }
    .sub { color: var(--muted); margin: 0 0 20px; }
    .notes { background: #111432; border-radius: 14px; padding: 14px; margin-top: 14px; border: 1px solid #ffffff14; }
    .footer { margin-top: 20px; text-align: center; font-size: 13px; color: var(--muted); }
    .btn {
      display: inline-block; padding: 10px 14px;
      background: linear-gradient(135deg, var(--accent), var(--accent-2)); color: white;
      text-decoration: none; border-radius: 10px; font-weight: 600; border: 0; cursor: pointer;
    }
    .photo { text-align: center; }
    .photo img {
  width: 60%;
  max-width: 400px;
  height: auto;
  border-radius: 16px;
  display: inline-block;
  opacity: 0;
  animation: fadeIn 1.8s ease forwards;
}

@keyframes fadeIn {
  0% { opacity: 0; transform: scale(0.96) translateY(6px); }
  100% { opacity: 1; transform: scale(1) translateY(0); }
}

    /* Hearts */
    .heart {
      position: fixed;
      pointer-events: none;
      animation: floatUp 1.6s ease forwards;
      filter: drop-shadow(0 5px 4px rgba(0,0,0,.25));
      will-change: transform, opacity;
    }
    @keyframes floatUp {
      0%   { transform: translateY(0) scale(.8) rotate(0deg); opacity: .95; }
      80%  { opacity: .9; }
      100% { transform: translateY(-140px) scale(1.05) rotate(15deg); opacity: 0; }
    }
    /* Quiz */
    .quiz-q { font-weight: 600; margin-bottom: 8px; }
    .quiz-opt { display: block; margin: 6px 0; background: #0d1030; padding: 8px 10px; border-radius: 10px; border: 1px solid #ffffff14; }
    .quiz-actions { margin-top: 10px; display: flex; gap: 10px; align-items: center; }
    .chip { background: #ffffff14; color: var(--text); padding: 6px 10px; border-radius: 999px; font-size: 13px; border: 1px solid #ffffff18; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Hey Vic, I Miss You</h1>
    <p class="sub" id="subtitle">Loading...</p>

    <div class="photo">
      <img id="preview" alt="Hank & Vic" />
    </div>

    <div class="notes">
      <h3>Note</h3>
      <p id="noteText"></p>
    </div>

    <div class="notes">
      <h3>Now Playing</h3>
      <div id="embed"></div>
    </div>

    <div class="notes">
      <h3>Compliment Generator</h3>
      <p id="compliment" class="sub" style="min-height:1.4em;"></p>
      <button id="complimentBtn" class="btn" type="button">‚ú® Give me a compliment</button>
    </div>

    <div class="notes">
      <h3> Hank Quiz</h3>
      <div id="quizBox"></div>
      <div class="quiz-actions">
        <button id="submitQuiz" class="btn" type="button">Submit</button>
        <span id="quizMsg" class="chip"></span>
      </div>
    </div>

    <div class="notes">
      <h3>Send a ‚ù§Ô∏è</h3>
      <button id="heartBtnShared" class="btn" type="button">Send a heart</button>
      <span id="heartLocal" class="sub" style="margin-left:8px">0 sent (from you)</span>
      <p class="sub" style="margin-top:8px">Tip: you can also click anywhere on the page to float a heart üíú</p>
    </div>

    <div class="footer">
      <a id="adminLink" href="#" class="btn" style="display:none">‚úèÔ∏è Edit Config</a>
      <p><a href="memories.html" class="btn">üì∏ View Memories</a></p>
      <p>Made with üíú by Hank</p>
    </div>
  </div>

  <script>
  const CONFIG_URL = '.config.json';
  const ADMIN_URL = ''; // optional GitHub edit link; leave blank to hide

  if (ADMIN_URL) {
    document.getElementById('adminLink').href = ADMIN_URL;
    document.getElementById('adminLink').style.display = 'inline-block';
  }

  function renderEmbed(url) {
    const embed = document.getElementById('embed');
    embed.innerHTML = '';
    try {
      if (url.includes('spotify.com/track')) {
        const id = (url.split('/track/')[1]||'').split('?')[0];
        embed.innerHTML = `<iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/${id}" width="100%" height="152" frameborder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>`;
      } else if (url.includes('youtube.com') || url.includes('youtu.be')) {
        const id = url.match(/[?&]v=([^&]+)/)?.[1] || url.split('youtu.be/')[1];
        embed.innerHTML = `<iframe width="100%" height="200" src="https://www.youtube.com/embed/${id}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>`;
      } else {
        embed.innerHTML = '<p class="sub">Add a Spotify or YouTube link in config.json</p>';
      }
    } catch {
      embed.innerHTML = '<p class="sub">Could not load song.</p>';
    }
  }

  // Hearts animation
  function spawnHearts(x, y) {
    const emojis = ['‚ù§','üíú','üíó','üíñ','üíò'];
    const colors = ['#ff7ab6', '#ffb3d6', '#ffd1e6', '#c7b8ff', '#9b87f5'];
    const n = 12;
    for (let i=0;i<n;i++) {
      const h = document.createElement('div');
      h.className = 'heart';
      h.textContent = emojis[i % emojis.length];
      h.style.left = (x + (Math.random()*60-30)) + 'px';
      h.style.top = (y + (Math.random()*20-10)) + 'px';
      h.style.fontSize = (18 + Math.random()*20) + 'px';
      h.style.color = colors[i % colors.length];
      h.style.transform = `translateY(0) rotate(${(Math.random()*40-20)}deg)`;
      document.body.appendChild(h);
      setTimeout(() => h.remove(), 1700);
    }
  }

  document.addEventListener('click', (e) => {
    if (!e.target.closest('#heartBtnShared, a, input, textarea, select, .btn')) {
      spawnHearts(e.clientX, e.clientY);
      incrementLocalHearts();
    }
  }, { passive: true });

  document.getElementById('heartBtnShared').addEventListener('click', (e) => {
    const rect = e.target.getBoundingClientRect();
    spawnHearts(rect.left + rect.width/2, rect.top);
    incrementLocalHearts();
  });

  function incrementLocalHearts(){
    const key = 'heartLocalCount';
    const count = (parseInt(localStorage.getItem(key) || '0', 10) + 1);
    localStorage.setItem(key, count);
    document.getElementById('heartLocal').textContent = `${count} sent (from you)`;
  }
  (function(){
    const key = 'heartLocalCount';
    const count = parseInt(localStorage.getItem(key) || '0', 10);
    document.getElementById('heartLocal').textContent = `${count} sent (from you)`;
  })();

  // Compliments
  let complimentList = [
    "You‚Äôre my favorite notification.",
    "You make ordinary days feel special.",
    "Your smile is my happy place.",
    "You + me > any algorithm.",
    "Distance: temporary. Us: persistent."
  ];

  function showCompliment(){
    if (!complimentList.length) return;
    const pick = complimentList[Math.floor(Math.random()*complimentList.length)];
    const el = document.getElementById('compliment');
    el.textContent = pick;
    el.animate([{opacity:0, transform:'translateY(6px)'},{opacity:1, transform:'translateY(0)'}], {duration:220, easing:'ease-out'});
  }
  document.getElementById('complimentBtn').addEventListener('click', showCompliment);

  // Quiz
  let quiz = {
    question: "Our next date idea?",
    options: ["üçï Pizza night", "üé¨ Movie", "üåá Sunset walk"],
    correctIndex: 2
  };

  function renderQuiz(){
    const box = document.getElementById('quizBox');
    box.innerHTML = '';
    const q = document.createElement('div');
    q.className = 'quiz-q';
    q.textContent = quiz.question;
    box.appendChild(q);

    quiz.options.forEach((opt, i) => {
      const id = 'opt-' + i;
      const label = document.createElement('label');
      label.className = 'quiz-opt';
      label.htmlFor = id;
      label.innerHTML = `<input type="radio" name="quiz" id="${id}" value="${i}" style="margin-right:8px"> ${opt}`;
      box.appendChild(label);
    });
  }
  renderQuiz();

  document.getElementById('submitQuiz').addEventListener('click', () => {
    const sel = document.querySelector('input[name="quiz"]:checked');
    const msg = document.getElementById('quizMsg');
    if (!sel) { msg.textContent = 'Pick one üòä'; return; }
    const idx = parseInt(sel.value, 10);
    if (idx === quiz.correctIndex) {
      msg.textContent = 'Correct! You know me too well ‚ù§Ô∏è';
    } else {
      msg.textContent = 'Cute guess! But I was thinking the other one üòò';
    }
  });

  async function loadConfig() {
    try {
      const res = await fetch(CONFIG_URL, { cache: 'no-store' });
      if (!res.ok) throw new Error('Failed to fetch config');
      const cfg = await res.json();
      document.getElementById('subtitle').textContent = cfg.subtitle || '';
      document.getElementById('noteText').textContent = cfg.note || '';
      if (cfg.photoUrl) document.getElementById('preview').src = cfg.photoUrl;
      if (cfg.songUrl) renderEmbed(cfg.songUrl);

      if (Array.isArray(cfg.compliments) && cfg.compliments.length) {
        complimentList = cfg.compliments;
      }
      if (cfg.quiz && cfg.quiz.question && Array.isArray(cfg.quiz.options) && typeof cfg.quiz.correctIndex === 'number') {
        quiz = cfg.quiz;
        renderQuiz();
      }
    } catch (err) {
      document.getElementById('subtitle').textContent = 'Could not load data.';
    }
  }

  loadConfig();
</script>

</body>
</html>
